(()=>{"use strict";window.cdLogger={},window.cdLogger.MAX_MESSAGES=100,window.cdLogger.PATHS={dev:"https://logging-api.dev-ng.stadium.providus.xyz/logs",int:"https://logging-api.int-ng.stadium.providus.xyz/logs",stg:"https://logging-api.stg-ng.stadium.providus.xyz/logs",prod:"https://logging-api.ng.stadium.providus.xyz/logs"},window.cdLogger.generateUUID=function(){var o=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(o+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var r=(o+16*Math.random())%16|0;return o=Math.floor(o/16),("x"===e?r:3&r|8).toString(16)}))},window.cdLogger.manageUserId=function(){var o=localStorage.getItem("userId");null==o&&(o=window.cdLogger.generateUUID(),localStorage.setItem("userId",o))},window.cdLogger.store=function(o,e,r){var n=JSON.parse(localStorage.getItem("logData"));null!=n&&0!=Array.isArray(n)||(n=[],localStorage.setItem("logData",JSON.stringify(n)));const t=sessionStorage.getItem("lastLoggedInClient"),g=localStorage.getItem("userId"),a=new Date(Date.now()).toISOString().replace("T"," ").replace("Z",""),s=location.hostname,i=location.pathname;n.push({source:o,userId:g,message:"string"!=typeof e?JSON.stringify(e):e,timestamp:a,env:s,path:i,logLevel:r,clientId:t}),n=n.slice(-window.cdLogger.MAX_MESSAGES),localStorage.setItem("logData",JSON.stringify(n))},window.onerror=function(o,e,r,n,t){},window.onload=function(){window.cdLogger.manageUserId(),window.cdLogger.log=console.log,console.log=function(...o){window.cdLogger.log(...o),window.cdLogger.store("console-log",o,"info")},window.cdLogger.error=console.error,console.error=function(...o){window.cdLogger.error(...o),window.cdLogger.store("console-error",o,"error")},window.cdLogger.warn=console.warn,console.warn=function(...o){window.cdLogger.warn(...o),window.cdLogger.store("console-warn",o,"warn")},window.cdLogger.info=console.info,console.info=function(...o){window.cdLogger.info(...o),window.cdLogger.store("console-info",o,"info")},window.cdLogger.trace=console.trace,console.trace=function(...o){window.cdLogger.trace(...o),window.cdLogger.store("console-trace",o,"info")},window.cdLogger.transmit=function(){var o=JSON.parse(localStorage.getItem("logData"));if(null!=o&&0!=o.length&&0!=Array.isArray(o))try{var e=new XMLHttpRequest,r=window.cdLogger.PATHS.prod||window.cdLogger.PATHS.dev,n=JSON.stringify({logs:o.map((o=>({message:`${o.userId}:${o.source}: ${o.message}`,timestamp:o.timestamp,logLevel:o.logLevel,appId:o.env,clientId:o.clientId||null,deviceId:o.userId})))});e.open("POST",r,!0),e.setRequestHeader("Content-type","application/json"),e.setRequestHeader("X-Providus-App-Version","v1.0.20"),e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var o=JSON.parse(e.responseText);1!==o.status?(window.cdLogger.store("transmit-bad-status",o,"error"),console.log("Status is not 1 in the response")):localStorage.setItem("logData",JSON.stringify([]))}},e.onerror=function(o){console.error(o)},e.send(n)}catch(o){const e=JSON.stringify(o);window.cdLogger.store("transmit-try-catch",e,"error")}},window.addEventListener("error",(function(o){const e=o.message,r=o.error.stack;window.cdLogger.store("handleError",`error: ${e}, stack: ${r}`,"error")})),window.addEventListener("unhandledrejection",(function(o){const e=o.reason.message,r=o.reason.stack;window.cdLogger.store("handleRejection",`error: ${e}, stack: ${r}`,"error")})),setInterval((function(){var o=JSON.parse(localStorage.getItem("logData"));o&&o.length>0?window.cdLogger.transmit():localStorage.setItem("logData",JSON.stringify([]))}),6e4)}})();